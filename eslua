-- Verhindert mehrfaches Laden des Skripts
if getgenv and getgenv().ATG_LOADED then
    error("AdvancedTabGui ist bereits geladen!", 0)
    return
end

if getgenv then
    getgenv().ATG_LOADED = true
end

-- AFK-Schutz Script
local VirtualUser = game:GetService("VirtualUser")
idleConnection = game:GetService("Players").LocalPlayer.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
    print("Roblox tried to kick you, but I prevented it.")
end)

-- Erstelle eine ScreenGui
local screenGui = Instance.new("ScreenGui")
local COREGUI = cloneref(game:GetService("CoreGui"))
screenGui.Name = "AdvancedTabGui"
screenGui.Parent = COREGUI

-- Erstelle eine Variable, um die Sichtbarkeit zu steuern
local isVisible = true

-- Erstelle ein Hauptframe
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 600, 0, 400)
mainFrame.Position = UDim2.new(0, 150, 0.5, -200)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Visible = isVisible
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui

-- Erstelle einen Tab Container (linke Seite)
local tabContainer = Instance.new("Frame")
tabContainer.Name = "TabContainer"
tabContainer.Size = UDim2.new(0, 150, 1, 0)
tabContainer.Position = UDim2.new(0, 0, 0, 0)
tabContainer.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
tabContainer.BorderSizePixel = 0
tabContainer.Parent = mainFrame

-- Erstelle einen Inhaltscontainer (rechte Seite)
local contentContainer = Instance.new("Frame")
contentContainer.Name = "ContentContainer"
contentContainer.Size = UDim2.new(1, -150, 1, 0)
contentContainer.Position = UDim2.new(0, 150, 0, 0)
contentContainer.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
contentContainer.BorderSizePixel = 0
contentContainer.Parent = mainFrame

-- UIListLayout für Tabs
local tabLayout = Instance.new("UIListLayout")
tabLayout.Parent = tabContainer
tabLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- Funktion, um Tabs zu erstellen
local function createTab(tabName)
    local tabButton = Instance.new("TextButton")
    tabButton.Name = tabName .. "Tab"
    tabButton.Size = UDim2.new(1, 0, 0, 50)
    tabButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    tabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    tabButton.Font = Enum.Font.SourceSans
    tabButton.TextSize = 18
    tabButton.Text = tabName
    tabButton.BorderSizePixel = 0
    tabButton.Parent = tabContainer

    -- Frame für den Tab-Inhalt
    local tabContent = Instance.new("Frame")
    tabContent.Name = tabName .. "Content"
    tabContent.Size = UDim2.new(1, 0, 1, 0)
    tabContent.BackgroundTransparency = 1
    tabContent.Visible = false
    tabContent.Parent = contentContainer

    -- Tab Button Funktionalität
    tabButton.MouseButton1Click:Connect(function()
        -- Alle Inhalte ausblenden
        for _, child in pairs(contentContainer:GetChildren()) do
            if child:IsA("Frame") then
                child.Visible = false
            end
        end

        -- Diesen Inhalt anzeigen
        tabContent.Visible = true
    end)

    return tabContent
end

-- Beispiel: Tabs erstellen
local homeTab = createTab("Home")
local settingsTab = createTab("Settings")
local universalTab = createTab("Universal")
local aboutTab = createTab("About")

-- Beispiel: Inhalte zu einem Tab hinzufügen
local exampleButton = Instance.new("TextButton")
exampleButton.Size = UDim2.new(0, 200, 0, 50)
exampleButton.Position = UDim2.new(0.5, -100, 0.5, -25)
exampleButton.BackgroundColor3 = Color3.fromRGB(70, 130, 180)
exampleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
exampleButton.Font = Enum.Font.SourceSans
exampleButton.TextSize = 18
exampleButton.Text = "Click Me!"
exampleButton.Parent = homeTab
exampleButton.MouseButton1Click:Connect(function()
    local gameId = game.GameId -- Die eindeutige ID des Spiels
    warn("Game ID: " .. tostring(gameId))
    warn("Toggle via F1!")
    warn("---")
end)

-- Funktionen im Settings-Tab hinzufügen
local settingsContent = settingsTab

local function createRescalableUI(labelText, placeholderText, positionY, onValueChange)
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0.3, 0, 0.1, 0)
    label.Position = UDim2.new(0.05, 0, positionY, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.SourceSans
    label.TextSize = 18
    label.Text = labelText
    label.Parent = settingsContent

    local input = Instance.new("TextBox")
    input.Size = UDim2.new(0.2, 0, 0.1, 0)
    input.Position = UDim2.new(0.4, 0, positionY, 0)
    input.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    input.TextColor3 = Color3.fromRGB(255, 255, 255)
    input.Font = Enum.Font.SourceSans
    input.TextSize = 18
    input.PlaceholderText = placeholderText
    input.Parent = settingsContent

    input.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            local newValue = tonumber(input.Text)
            if newValue then
                onValueChange(newValue)
            end
        end
    end)

    return label, input
end

-- Walkspeed UI
createRescalableUI("Walkspeed:", "16", 0.1, function(newWalkspeed)
    game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = newWalkspeed
end)

-- Jump Power UI
createRescalableUI("Jump Power:", "50", 0.3, function(newJumpPower)
    game.Players.LocalPlayer.Character.Humanoid.UseJumpPower = true
    game.Players.LocalPlayer.Character.Humanoid.JumpPower = newJumpPower
end)

-- Jump Height UI (Neue Funktion hinzufügen)
createRescalableUI("Jump Height:", "50", 0.5, function(newJumpHeight)
    game.Players.LocalPlayer.Character.Humanoid.JumpHeight = newJumpHeight
end)

----------------------------------------------------------------------------
-- Funktionen im Universal-Tab hinzufügen
local espTab = universalTab

-- ESP-Funktion
local function createESP(player)
    if not player.Character or player.Character:FindFirstChild("ESP_Highlight") then
        return
    end
    local highlight = Instance.new("Highlight")
    highlight.Name = "ESP_Highlight"
    highlight.Parent = player.Character
    highlight.FillTransparency = 0.5
    highlight.OutlineTransparency = 0
    highlight.FillColor = Color3.fromRGB(255, 0, 0)
end

-- Checkbox für ESP-Aktivierung
local espEnabled = false
local espCheckbox = Instance.new("TextButton")
espCheckbox.Size = UDim2.new(0, 200, 0, 50)
espCheckbox.Position = UDim2.new(0.05, 0, 0.1, 0)
espCheckbox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
espCheckbox.TextColor3 = Color3.fromRGB(255, 255, 255)
espCheckbox.Font = Enum.Font.SourceSans
espCheckbox.TextSize = 18
espCheckbox.Text = "ESP: OFF"
espCheckbox.Parent = universalTab

espCheckbox.MouseButton1Click:Connect(function()
    espEnabled = not espEnabled
    espCheckbox.Text = espEnabled and "ESP: ON" or "ESP: OFF"

    if espEnabled then
        for _, player in pairs(game:GetService("Players"):GetPlayers()) do
            if player ~= game.Players.LocalPlayer then
                createESP(player)
            end
        end
    else
        for _, player in pairs(game:GetService("Players"):GetPlayers()) do
            if player.Character and player.Character:FindFirstChild("ESP_Highlight") then
                player.Character:FindFirstChild("ESP_Highlight"):Destroy()
            end
        end
    end
end)

-- Spieler-Beitritts- und Verlassens-Handling
local Players = game:GetService("Players")
Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        if espEnabled then
            createESP(player)
        end
    end)
end)

Players.PlayerRemoving:Connect(function(player)
    if player.Character and player.Character:FindFirstChild("ESP_Highlight") then
        player.Character:FindFirstChild("ESP_Highlight"):Destroy()
    end
end)
----------------------------------------------------------------------------

-- Funktionen im About-Tab hinzufügen
local aboutContent = aboutTab

local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0.3, 0, 0.1, 0)
    label.Position = UDim2.new(0.25, 0, 0.1, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.SourceSans
    label.TextSize = 18
    label.Text = "Hi you can toggle this UI with F1"
    label.Parent = aboutContent

-- Standard-Tab sichtbar machen
homeTab.Visible = true

-- Close Button erstellen
local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -40, 0, 10)
closeButton.BackgroundTransparency = 1
closeButton.Font = Enum.Font.SourceSans
closeButton.TextSize = 18
closeButton.Text = "❌"
closeButton.Parent = mainFrame

closeButton.MouseButton1Click:Connect(function()
    getgenv().ATG_LOADED = false
    espEnabled = false
    for _, player in pairs(game:GetService("Players"):GetPlayers()) do
        if player.Character and player.Character:FindFirstChild("ESP_Highlight") then
            player.Character:FindFirstChild("ESP_Highlight"):Destroy()
        end
    end
    screenGui:Destroy()
end)

-- Sichtbarkeit umschalten mit Taste (z. B. F1-Taste)
local UIS = game:GetService("UserInputService")
UIS.InputBegan:Connect(function(input, processed)
    if not processed and input.KeyCode == Enum.KeyCode.F1 then
        isVisible = not isVisible
        mainFrame.Visible = isVisible
    end
end)

-- Resize Funktion hinzufügen
local resizeHandle = Instance.new("Frame")
resizeHandle.Name = "ResizeHandle"
resizeHandle.Size = UDim2.new(0, 20, 0, 20)
resizeHandle.Position = UDim2.new(1, -20, 1, -20)
resizeHandle.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
resizeHandle.BorderSizePixel = 0
resizeHandle.Parent = mainFrame
resizeHandle.Active = true

resizeHandle.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        -- Draggable deaktivieren, um Resizing zu ermöglichen
        mainFrame.Draggable = false

        local startPos = input.Position
        local startSize = mainFrame.Size

        -- Verbindung für Mausbewegungen erstellen
        local moveConnection
        local releaseConnection

        moveConnection = game:GetService("UserInputService").InputChanged:Connect(function(moveInput)
            if moveInput.UserInputType == Enum.UserInputType.MouseMovement then
                -- Differenz berechnen und Größe aktualisieren
                local delta = moveInput.Position - startPos
                local newWidth = math.max(200, startSize.X.Offset + delta.X)
                local newHeight = math.max(200, startSize.Y.Offset + delta.Y)
                mainFrame.Size = UDim2.new(0, newWidth, 0, newHeight)
            end
        end)

        -- Überwachung des Input-Endes
        releaseConnection = input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                -- Verbindungen sicher trennen
                moveConnection:Disconnect()
                releaseConnection:Disconnect()
                -- Draggable wieder aktivieren
                mainFrame.Draggable = true
            end
        end)
    end
end)

-- Licht-Button für Universal-Tab hinzufügen
local lightEnabled = false
local lightButton = Instance.new("TextButton")
lightButton.Size = UDim2.new(0, 200, 0, 50)
lightButton.Position = UDim2.new(0.05, 0, 0.3, 0)
lightButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
lightButton.TextColor3 = Color3.fromRGB(255, 255, 255)
lightButton.Font = Enum.Font.SourceSans
lightButton.TextSize = 18
lightButton.Text = "Licht: OFF"
lightButton.Parent = universalTab

-- Lichtsteuerung
local lighting = game:GetService("Lighting")
local player = game.Players.LocalPlayer

lightButton.MouseButton1Click:Connect(function()
    lightEnabled = not lightEnabled
    lightButton.Text = lightEnabled and "Licht: ON" or "Licht: OFF"

    if lightEnabled then
        -- Lokales Licht aktivieren
        if player.Character then
            local rootPart = player.Character:FindFirstChild("HumanoidRootPart")
            if rootPart and not rootPart:FindFirstChild("PointLight") then
                local pointLight = Instance.new("PointLight")
                pointLight.Parent = rootPart
                pointLight.Brightness = 2
                pointLight.Range = 16
                pointLight.Color = Color3.new(1, 1, 1)
            end
        end

        -- Globale Beleuchtung aktivieren
        lighting.Brightness = 3
        lighting.ClockTime = 14
        lighting.OutdoorAmbient = Color3.new(0.5, 0.5, 0.5)
        lighting.FogEnd = 100000
    else
        -- Lokales Licht deaktivieren
        if player.Character then
            local rootPart = player.Character:FindFirstChild("HumanoidRootPart")
            if rootPart and rootPart:FindFirstChild("PointLight") then
                rootPart:FindFirstChild("PointLight"):Destroy()
            end
        end

        -- Globale Beleuchtung zurücksetzen
        lighting.Brightness = 1
        lighting.ClockTime = 14
        lighting.OutdoorAmbient = Color3.new(0, 0, 0)
        lighting.FogEnd = 1000 -- Standard-Nebeleinstellung
    end
end)

-- Überwache Charakteränderungen, um Licht neu zu erstellen, falls benötigt
player.CharacterAdded:Connect(function(character)
    if lightEnabled then
        local rootPart = character:WaitForChild("HumanoidRootPart")
        local pointLight = Instance.new("PointLight")
        pointLight.Parent = rootPart
        pointLight.Brightness = 2
        pointLight.Range = 16
        pointLight.Color = Color3.new(1, 1, 1)
    end
end)

---------------------------------------------------------------------------------------------------------------------------------

-- Zeichenkonvertierungstabellen
local conversionTableUpper = {
    A = "Ạ", B = "Ḅ", C = "C", D = "Ḍ", E = "Ẹ",
    F = "F", G = "Ģ", H = "Ḥ", I = "Ị", J = "J",
    K = "Ḳ", L = "Ḷ", M = "Ṃ", N = "Ṇ", O = "Ọ",
    P = "Р", Q = "Q", R = "Ṛ", S = "Ṣ", T = "Ṭ",
    U = "Ụ", V = "Ṿ", W = "Ẉ", X = "Ẋ", Y = "Ỵ", Z = "Ẓ"
}

local conversionTableLower = {
    a = "ạ", b = "ḅ", c = "c", d = "ḍ", e = "ẹ",
    f = "f", g = "ɡ", h = "ḥ", i = "ị", j = "ј",
    k = "ḳ", l = "ḷ", m = "ṃ", n = "ṇ", o = "ọ",
    p = "р", q = "q", r = "ṛ", s = "ṣ", t = "ṭ",
    u = "ụ", v = "ṿ", w = "ẉ", x = "ẋ", y = "ỵ", z = "ẓ", ["|"] = "\r",
}

-- Funktion zur Zeichenkonvertierung
local function convertText(text)
    local convertedText = ""
    for i = 1, #text do
        local char = text:sub(i, i)
        if conversionTableUpper[char] then
            convertedText = convertedText .. conversionTableUpper[char]
        elseif conversionTableLower[char] then
            convertedText = convertedText .. conversionTableLower[char]
        else
            convertedText = convertedText .. char -- Unveränderte Zeichen hinzufügen
        end
    end
    return convertedText
end

-- Eingabefeld für den Chat in die GUI integrieren
local chatInput = Instance.new("TextBox")
chatInput.Size = UDim2.new(0.7, -10, 0.1, -5) -- Passt sich an den Stil an
chatInput.Position = UDim2.new(0.05, 0, 0.6, 0)
chatInput.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
chatInput.TextColor3 = Color3.fromRGB(255, 255, 255)
chatInput.Font = Enum.Font.SourceSansBold
chatInput.TextSize = 18
chatInput.PlaceholderText = "Nachricht eingeben..."
chatInput.ClearTextOnFocus = false
chatInput.Text = ""  -- Entfernt den Standardtext
chatInput.Parent = universalTab

-- Button für das Senden der Nachricht
local sendButton = Instance.new("TextButton")
sendButton.Size = UDim2.new(0.2, -5, 0.1, -5) -- Neben dem Eingabefeld
sendButton.Position = UDim2.new(0.75, 5, 0.6, 0)
sendButton.BackgroundColor3 = Color3.fromRGB(70, 130, 180)
sendButton.TextColor3 = Color3.fromRGB(255, 255, 255)
sendButton.Font = Enum.Font.SourceSansBold
sendButton.TextSize = 18
sendButton.Text = "Senden"
sendButton.Parent = universalTab

-- Nachrichtensenden-Funktion
local function sendMessageToChat(message)
    local textChatService = game:GetService("TextChatService")
    local generalChannel = textChatService.TextChannels:FindFirstChild("RBXGeneral")

    if generalChannel then
        local convertedMessage = convertText(message) -- Konvertiere Nachricht
        pcall(function()
            generalChannel:SendAsync(convertedMessage)
        end)
    else
        warn("Der RBXGeneral-Chatkanal wurde nicht gefunden.")
    end
end

-- Button-Klick-Funktion
sendButton.MouseButton1Click:Connect(function()
    local message = chatInput.Text
    if message and message ~= "" then
        sendMessageToChat(message)
        chatInput.Text = "" -- Eingabefeld leeren
    end
end)

-- Eingabetaste nutzen
chatInput.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        local message = chatInput.Text
        if message and message ~= "" then
            sendMessageToChat(message)
            chatInput.Text = "" -- Eingabefeld leeren
        end
    end
end)
